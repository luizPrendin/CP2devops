# CP2devops

# Video do Youtube:
---link

# Documentação

- Dockerfile:
```Dockerfile
# Usar a imagem base do JDK 17
FROM openjdk:17-jdk-slim AS build

# Definir o diretório de trabalho
WORKDIR /app

# Copiar os arquivos de construção do Gradle
COPY gradle gradle
COPY build.gradle settings.gradle ./
COPY src src/
COPY gradlew ./
COPY gradlew.bat ./

# Dar permissão de execução ao script gradlew
RUN chmod +x gradlew

#tive que adicionar essa duas linhas pois o meu pc não estava reconhecendo gradle
RUN apt-get update && apt-get install -y dos2unix
RUN dos2unix gradlew

# Executar o comando de construção do Gradle
RUN ./gradlew build --no-daemon

# Usar uma imagem mais leve para a aplicação final
FROM openjdk:17-jdk-slim

# Definir o diretório de trabalho
WORKDIR /app

# Copiar o JAR gerado da fase de construção
COPY --from=build /app/build/libs/*.jar app.jar

# Expor a porta 8081
EXPOSE 8081

# Comando para executar a aplicação
ENTRYPOINT ["java", "-jar", "app.jar"]

```
- Comandos cmd:
```Dockerfile
//Buildar a imagem
docker build -t imagem .

//Testar a imagem local
docker run -d -p 8080:8080 imagem

//Criar grupo de recurso
az group create --name rg-devopsCP --location eastus
 
//Criar ACR
az acr create --resource-group rg-devopsCP --name escolaapi --sku Basic
 
//Logar no ACR
az acr login --name escolaapi

//Colocar tag pra subir no ACR
docker tag imagem escolaapi.azurecr.io/escolaapi:v1

//Subir no ACR
docker push escolaapi.azurecr.io/escolaapi:v1
 
//Testar puxando imagem do ACR local
//docker run -d -p 8081:8081 escolaapi.azurecr.io/escolaapi:v1

//Entrar no recurso criado, configurações chaves de acesso e habilitar a caixinha de admin

//Logar novamente usando a senha gerada pelo azure
az acr login --name escolaapi --username escolaapi --password colocar-a-senha-aqui


az container create `
--resource-group rg-devopsCP `
--name escolaapi `
--image escolaapi.azurecr.io/escolaapi:v1 `
--cpu 1 `
--memory 1 `
--registry-login-server escolaapi.azurecr.io `
--registry-username escolaapi `
--registry-password colocar-a-senha-aqui `
--ip-address Public `
--dns-name-label escolaapi `
--ports 8081
```

- Script sql(Oracle):
```sql
-- Criação da tabela PROFESSOR
CREATE TABLE PROFESSOR (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL
);

-- Criação da tabela ALUNO
CREATE TABLE ALUNO (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL,
    PROFESSOR_ID NUMBER,
    CONSTRAINT FK_ALUNO_PROFESSOR FOREIGN KEY (PROFESSOR_ID) 
    REFERENCES PROFESSOR(ID) ON DELETE SET NULL
);

```

# Integrantes
- Luiz Felipe RM552475
- Rennan Ferreira RM99364
- Jaisy Cibele RM552269





